<!DOCTYPE html>
<html>

<head>
    <!-- // -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  Head Section Meta Char Info 
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- // -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  Head Section A.2: CSS tied to SASS/SCSS File + Bootstrap
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <!-- // -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  Head Section A.3: Google Fonts
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- -->

    <link href="https://fonts.googleapis.com/css?family=Girassol&display=swap" rel="stylesheet">

    <!-- // -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  Head Section A.3: Font Awesome
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- -->

    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/solid.js"
        integrity="sha384-tzzSw1/Vo+0N5UhStP3bvwWPq+uvzCMfrN1fEFe+xBmv1C/AtVX5K0uZtmcHitFZ" crossorigin="anonymous">
    </script>
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/fontawesome.js"
        integrity="sha384-6OIrr52G08NpOFSZdxxz1xdNSndlD4vdcf/q2myIUVO0VsqaGHJsB0RaBE01VTOY" crossorigin="anonymous">
    </script>

    <!-- // -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  Head Section A.4: Projec CSS files using SASS
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- -->

    <link rel="stylesheet" type="text/css" href="/css/index.css">
    <link rel="stylesheet" type="text/css" href="/css/app.css">

    <title>VitX</title>

    <script src="https://code.jquery.com/jquery.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

</head>

<body>

    <nav>
        <ul>
            <li><a href="/auth/logout">Logout</a></li>
            <li><a href="/auth/login">Login</a></li>
            <li><a href="/">Homepage</a></li>
        </ul>
    </nav>
    <header>
        <h1>Welcome to your profile, <%= user %>!</h1>
        <h2 id="userID"> Your id is: <%= id%>.</h2>

    </header>
    <main>

        <!-- // -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  ACTUAL HTML :: Sidebar
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- -->
        <div id=MasterDiv class="wrapper container-fluid">

            <nav id="sidebar">
                <div class="sidebar-header">

                    <h3>
                        <img src="/svg/Fitness_SVG/003-heart.svg" alt="triangle with all three sides equal" height="50"
                            width="58" />
                        VitX</h3>
                </div>

                <ul class="list-unstyled components">
                    <p>Quote of the day: Be strong in your beliefs and do not falter! - Some Web Developer</p>

                    <li class="active">
                        <a href="#homeSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle"><img
                                src="/svg/UserNav_SVG/163-home.svg" alt="triangle with all three sides equal"
                                height="50" width="58" />Overview</a>
                        <ul class="collapse list-unstyled" id="homeSubmenu">
                            <li>
                                <a href="#">Calorie Intake</a>
                            </li>
                            <li>
                                <a href="#">Time Value Diagram</a>
                            </li>
                            <!-- <li>
              <a href="#"></a>
            </li> -->
                        </ul>
                    </li>

                    <li>
                        <a href="#pageSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">
                            <img src="/svg/Fitness_SVG/050-dumbbells.svg" alt="triangle with all three sides equal"
                                height="50" width="58" />Workout</a>
                        <ul class="collapse list-unstyled" id="pageSubmenu">
                            <li>
                                <a href="#">Exercise List</a>
                            </li>
                            <li>
                                <a href="#">Begin a Workout</a>
                            </li>
                            <li>
                                <a href="#">Check and Update Progress</a>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#pageSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">
                            <img src="/svg/Fitness_SVG/082-salad.svg" alt="triangle with all three sides equal"
                                height="50" width="58" />Nutrition</a>
                        <ul class="collapse list-unstyled" id="pageSubmenu">
                            <li>
                                <a href="#">Nutrition List</a>
                            </li>
                            <li>
                                <a href="#">Log Daily Consumption</a>
                            </li>
                            <li>
                                <a href="#">Check and Update Nutritional Progress</a>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#">
                            <img src="/svg/UserNav_SVG/168-presentation-1.svg" alt="triangle with all three sides equal"
                                height="50" width="58" />

                            Progress</a>
                    </li>
                    <li>
                        <a href="#"><img src="/svg/UserNav_SVG/320-archive.svg"
                                alt="triangle with all three sides equal" height="50" width="58" />About</a>
                    </li>
                    <li>
                        <a href="#">
                            <img src="/svg/UserNav_SVG/206-chat.svg" alt="triangle with all three sides equal"
                                height="50" width="58" />
                            Contact</a>
                    </li>
                </ul>
            </nav>

            <div id="content" class='container-fluid'>
                <nav id="menu" class="navbar navbar-expand-lg navbar-dark bg-transparent">
                    <div class="container-fluid">

                        <button type="button" id="sidebarCollapse" class="btn btn-transparent">
                            <i class="fas fa-align-left"></i>
                            <!-- <span>Toggle Sidebar</span> -->
                        </button>

                        <div class='container-fluid bg-transparent text-warning text-center'>
                            <h3>Welcome Back </h3>
                        </div>



                    </div>
                </nav>

                </br>
                </br>


                <!-- // -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  ACTUAL HTML :: Landing Page
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- -->
                <div class='container-fluid'>

                    <div class='row'>
                        <div class='col-md-12'>
                            <div id='box1' class='jumbotron bg-transparent'>
                                <div class='row'>
                                    <div class=col-md-4>


                                        <!-- Current Calorie Uptake -->
                                        <div id='box1' class='jumbotron bg-transparent'>


                                        </div>
                                    </div>

                                    <div class=col-md-4>
                                        <div id='box1' class='jumbotron bg-transparent'>


                                        </div>
                                    </div>

                                    <div class=col-md-4>
                                        <div id='box1' class='jumbotron bg-transparent'>


                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>





                    <div class='row'>
                        <div class='col-md-12'>
                            <div id='box3' class='jumbotron bg-transparent'>
                                <div class='row'>
                                    <div class='col-md-12'>
                                        <div id='box3' class='jumbotron bg-transparent'>

                                            <h4>View user data</h4>
                                            <button id="view-workouts-btn">view workouts data</button>
                                            <button id="view-nutrition-btn">view nutrition data</button>
                                            <br>

                                            <h4>Response data</h4>
                                            <div id="userData">
                                            </div>
                                            <br>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class='row'>
                        <div class='col-md-12'>
                            <div id='box5' class='jumbotron bg-transparent'>
                                <div class='row'>
                                    <div class='col-md-12'>
                                        <div id='box5' class='jumbotron bg-transparent'>

                                        </div>

                                        <div id='box5' class='jumbotron bg-transparent'>

                                            <h4>Search exercise</h4>
                                            <form id="search-exercises">
                                                <input type="text" name="inputW">
                                            </form>
                                            <button id="workouts-btn">search exercise</button>
                                            <br>
                                            <form id="exercises-form">
                                                <div id="exercises-topost"></div>
                                            </form>
                                            <button id="post-exercises">add exercises</button>

                                        </div>

                                        <div id='box5' class='jumbotron bg-transparent'>

                                            <h4>Response data</h4>
                                            <div id="exercisesData">
                                            </div>
                                            <br>

                                        </div>

                                        <div id='box5' class='jumbotron bg-transparent'>



                                        </div>


                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class='row'>
                        <div class='col-md-12'>
                            <div id='box6' class='jumbotron bg-transparent'>
                                <div class='row'>
                                    <div class='col-md-12'>
                                        <div id='box3' class='jumbotron bg-transparent'>

                                        </div>

                                        <div id='box3' class='jumbotron bg-transparent'>

                                            <h4>Search food</h4>
                                            <form id="search-nutrition">
                                                <input type="text" name="inputN" id="foodSearch">
                                            </form>
                                            <button id="nutrition-btn">search food</button>
                                            <br>
                                            <form id="nutrition-form">
                                                <div id="nutrition-topost"></div>
                                            </form>
                                            <button id="post-nutrition">add nutrition</button>

                                        </div>

                                        <div id='box3' class='jumbotron bg-transparent'>

                                            <h4>Response data</h4>
                                            <div id="foodData">
                                            </div>
                                            <br>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class='row'>
                        <div class='col-md-12'>
                            <div id='box7' class='jumbotron bg-transparent'>




                            </div>
                        </div>
                    </div>

                    <!-- app container end div-->
                </div>

                <div class='row'>
                    <div class='col-md-12'>
                        <div id='pageClear' class='jumbotron bg-transparent'>

                            <!-- </br>
              </br>
              </br>
              </br>
              </br>
              </br>
              </br>
              </br>
              </br>
              </br>
              </br>
              </br>
              </br>
              </br> -->









                            <!-- <img src="./svg/Fitness_SVG/003-heart.svg" alt="triangle with all three sides equal" height="50"
                width="58" /> -->



                        </div>
                    </div>
                </div>
            </div>


            <!-- // -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  ACTUAL HTML :: First Section
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- -->

            <!-- // -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  ACTUAL HTML :: Second Section
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- -->

            <!-- // -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  ACTUAL HTML :: Third Section
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- -->

        </div>
        </div>




        <!-- // -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  Head Section Z.1: javascript CDNs for GSAP  
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- -->
        <script src="https://cdn.jsdelivr.net/npm/gsap@3.0.1/dist/gsap.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/gsap@3.0.1/dist/CSSRulePlugin.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/gsap@3.0.1/dist/Draggable.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/gsap@3.0.1/dist/EaselPlugin.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/gsap@3.0.1/dist/EasePack.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/gsap@3.0.1/dist/MotionPathPlugin.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/gsap@3.0.1/dist/PixiPlugin.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/gsap@3.0.1/dist/ScrollToPlugin.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/gsap@3.0.1/dist/TextPlugin.min.js"></script>


        <!-- // -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  Head Section Z.1: Optional Javascript
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- -->
        <script src="/libraries/p5.js"></script>
        <script src="/libraries/d3.js"></script>
        <script src="/Animation/home_gsap.js"></script>
        <script src="/design/app_design.js"></script>




        <!-- // -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  Head Section Z.3. jQuery, Bootstrap, & Popper.js
  //-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- -->
        <!-- <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous">
        </script> -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
            integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous">
        </script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
            integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous">
        </script>
        <!-- jQuery Custom Scroller CDN -->
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.concat.min.js">
        </script>



    </main>

    <div>

        <div>
            <h4>Search exercise</h4>
            <form id="search-exercises">
                <input type="text" name="inputW">
            </form>
            <button id="workouts-btn">search exercise</button>

            <h4>Search food</h4>
            <form id="search-nutrition">
                <input type="text" name="inputN" id="foodSearch">
            </form>
            <button id="nutrition-btn">search food</button>
            <br>

            <h4>View user data</h4>
            <button id="view-workouts-btn">view workouts data</button>
            <button id="view-nutrition-btn">view nutrition data</button>
            <br>

            <h4>Response data</h4>
            <div id="data">
            </div>
            <br>

            <form id="exercises-form">
                <div id="exercises-topost"></div>
            </form>
            <form id="nutrition-form">
                <div id="nutrition-topost"></div>
            </form>

            <button id="post-exercises">add exercises</button>
            <button id="post-nutrition">add nutrition</button>

        </div>

        <script>

            $(document).ready(function () {

                console.log("javascript loaded")

                // for searching:

                $("#workouts-btn").on("click", function () {

                    let exercise = $("#search-exercises")[0].elements[0].value;

                    console.log(exercise);

                    $.get("api/exercises", function (data) {
                        let results = [];
                        for (let i = 0; i < data.length; i++) {
                            if (data[i].name.includes(exercise)) {
                                results.push(data[i]);
                            }
                        }
                        console.log(results);

                        for (let i = 0; i < results.length; i++) {

                            let options = $("<button id=" + results[i].exerciseID + ">");
                            options.html(results[i].name);
                            options.attr("class", "exercise")
                            options.appendTo($("#exercisesData"));

                        }

                    });

                })

                // edemam API

                let foodOptions = [];

                $("#nutrition-btn").on("click", function () {

                    let food = $('#foodSearch').val();

                    let app_id = "319d5cf3";

                    let app_key = "a6b7b2b30443063fa2630ff0dbc8f735"

                    let queryURL = "https://api.edamam.com/api/food-database/parser?limit=5&app_id=" +
                        app_id + "&app_key=" + app_key + "&ingr=" + food;

                    $.ajax({
                            url: queryURL,
                            method: "GET"
                        })

                        // Function is .then() called with the response object:

                        .then(function (response) {

                            // Console logs the response to see what the object looks like, how to retrieve information:

                            console.log(response);

                            for (let i = 0; i < response.hints.length; i++) {
                                foodOptions.push(response.hints[i]);
                                let options = $("<button id=" + response.hints[i].food.label + ">");
                                options.html(response.hints[i].food.label);
                                options.attr("class", "nutrition");
                                options.attr("id", response.hints[i].food.foodId)
                                options.appendTo($("#foodData"));

                            }

                        });

                });

                // for adding items to submit to server:

                let exercisePostArray = [];

                $(document).on("click", ".exercise", function () {

                    $("#exercises-topost").html("");

                    console.log("add exercise to post form");

                    let thisID = this.id;

                    console.log(this);

                    $.get("api/exercises", function (data) {

                        for (let i = 0; i < data.length; i++) {

                            if (data[i].exerciseID === thisID) {
                                exercisePostArray.push(data[i]);
                            }
                        }

                        for (let i = 0; i < exercisePostArray.length; i++) {
                            let postExerciseDiv = $("<div>");
                            let postExercise = $("<p>");
                            let multiplier = $("<input type='number' name='multiplier'>");
                            $(multiplier).attr('id', 'multiplier_' + i);
                            $(postExercise).html(exercisePostArray[i].name);
                            $(postExercise).appendTo(postExerciseDiv);
                            $(multiplier).appendTo(postExerciseDiv);
                            $("#exercises-topost").append(postExerciseDiv);
                        }

                    });

                })

                let nutritionPostArray = [];

                $(document).on("click", ".nutrition", function () {

                    $("#nutrition-topost").html("");

                    console.log("add nutrition to post form");

                    let thisID = this.id;

                    for (let i = 0; i < foodOptions.length; i++) {

                        if (foodOptions[i].food.foodId === thisID) {
                            nutritionPostArray.push(foodOptions[i].food);
                        }
                    }

                    for (let i = 0; i < nutritionPostArray.length; i++) {
                        let postNutritionDiv = $("<div>");
                        let postNutrition = $("<p>");
                        let multiplier = $("<input type='number' name='multiplier'>");
                        $(multiplier).attr('id', 'multiplier_' + i);
                        $(postNutrition).html(nutritionPostArray[i].label);
                        $(postNutrition).appendTo(postNutritionDiv);
                        $(multiplier).appendTo(postNutritionDiv);
                        $("#exercises-topost").append(postNutritionDiv);
                    }

                })


                // for posting to server:

                $("#post-exercises").on("click", function () {

                    console.log(exercisePostArray)

                    for (let i = 0; i < exercisePostArray.length; i++) {

                        let multiplierInput = 1;
                        
                        if ($('#multiplier_' + i).val() != 1) {
                            let multiplierInput = $('#multiplier_' + i).val();
                        }
                    
                        

                        let userID = $('#userID').html();
                        console.log(userID);


                        exercisePostArray[i].userID = userID;
                        exercisePostArray[i].multiplier = multiplierInput;
                        console.log(exercisePostArray[i]);
                    }

                    $.ajax({
                        url: '/profile/api/workouts',
                        method: 'POST',
                        contentType: 'application/json',
                        data: JSON.stringify({
                            data: exercisePostArray
                        })
                    }).then(function (data) {
                        console.log(data);
                    })

                })

                $("#post-nutrition").on("click", function () {

                    console.log(nutritionPostArray);

                    for (let i = 0; i < nutritionPostArray.length; i++) {

                        let multiplierInput = 1;
                        
                        if ($('#multiplier_' + i).val() != 1) {
                            let multiplierInput = $('#multiplier_' + i).val();
                        }


                        let userID = $('#userID').html();
                        console.log(userID);

                        exercisePostArray[i].userID = userID;
                        nutritionPostArray[i].multiplier = multiplierInput;
                        console.log(nutritionPostArray[i]);

                    }

                    $.ajax({
                        url: '/profile/api/nutrition',
                        method: 'POST',
                        contentType: "application/json",
                        data: JSON.stringify({
                            data: nutritionPostArray
                        })
                    }).then(function (data) {
                        console.log(data);
                    })

                })

                // for viewing saved user data:

                $("#view-workouts-btn").on("click", function (event) {

                    event.preventDefault();

                    console.log("view");

                    $.get("api/workouts", function (data) {

                        console.log(data)

                        // for each character that our server sends us back
                        for (let i = 0; i < data.length; i++) {
                            // create a parent div for the oncoming elements
                            let workoutData = $("<div>");
                            // add a class to this div
                            workoutData.addClass("workoutData");
                            // add an id to the well to mark 
                            workoutData.attr("id", "workoutData" + i);

                            let WOName = $('<p>');
                            let WOCals = $('<p>');
                            let WODate = $('<p>');

                            WOName.html(data[i].name);
                            WOCals.html(data[i].calories);
                            WODate.html(data[i].date);

                            WOName.appendTo(workoutData);
                            WOCals.appendTo(workoutData);
                            WODate.appendTo(workoutData);


                            // append the div to data div
                            $("#userData").append(workoutData);

                            // get data from workouts data

                        }
                    });
                })

                $("#view-nutrition-btn").on("click", function (event) {

                    $.get("api/nutrition", function (data) {

                        console.log(data)

                        // for each food that our server sends us back

                        for (let i = 0; i < data.length; i++) {
                            // create a parent div for the oncoming elements
                            let nutritionData = $("<div>");
                            // add a class to this div
                            nutritionData.addClass("nutritionData");
                            // add an id to the well to mark 
                            nutritionData.attr("id", "nutritionData" + i);

                            let foodName = $('<p>');
                            let foodCals = $('<p>');
                            let foodDate = $('<p>');

                            foodName.html(data[i].name);
                            foodCals.html(data[i].calories);
                            foodDate.html(data[i].date);

                            foodName.appendTo(nutritionData);
                            foodCals.appendTo(nutritionData);
                            foodDate.appendTo(nutritionData);

                            // append the div to data div
                            $("#userData").append(nutritionData);

                            // get data from nutrition table

                        }
                    });
                });



            });
        </script>

</body>



</html>